[Unit]
Description=WashDB Verification Service (LLM-Based)
After=network.target postgresql.service ollama.service
Wants=ollama.service

[Service]
Type=simple
User=rivercityscrape
Group=rivercityscrape

# Load environment variables
EnvironmentFile=/home/rivercityscrape/URL-Scrape-Bot/washdb-bot/.env
EnvironmentFile=-/home/rivercityscrape/URL-Scrape-Bot/washdb-bot/systemd/washdb-bot.env

WorkingDirectory=/home/rivercityscrape/URL-Scrape-Bot/washdb-bot
Environment="PYTHONUNBUFFERED=1"
Environment="OLLAMA_MODEL=unified-washdb"

ExecStart=/home/rivercityscrape/URL-Scrape-Bot/washdb-bot/venv/bin/python scripts/run_verification_workers.py --workers 4

# Restart policy
Restart=on-failure
RestartSec=30

# Logging
StandardOutput=append:/home/rivercityscrape/URL-Scrape-Bot/washdb-bot/logs/verification_service.log
StandardError=append:/home/rivercityscrape/URL-Scrape-Bot/washdb-bot/logs/verification_service_error.log

# Resource limits
MemoryMax=4G

[Install]
WantedBy=multi-user.target
